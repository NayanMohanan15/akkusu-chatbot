  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Akkusu GPT - Personal AI Assistant</title>
      <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
      <style>
          :root {
              --primary-color: #6C63FF;
              --secondary-color: #4D44DB;
              --accent-color: #FF6584;
              --light-bg: #F8F9FF;
              --dark-text: #2E2E48;
              --light-text: #6D6D80;
              --white: #FFFFFF;
              --shadow: 0 10px 30px rgba(108, 99, 255, 0.2);
              --border-radius: 16px;
          }
          
          * {
              box-sizing: border-box;
              margin: 0;
              padding: 0;
              font-family: 'Poppins', sans-serif;
          }
          
          body {
              background: linear-gradient(135deg, #F8F9FF 0%, #E6E9FF 100%);
              display: flex;
              justify-content: center;
              align-items: center;
              min-height: 100vh;
              padding: 20px;
          }
          
          .chat-container {
              width: 100%;
              max-width: 500px;
              height: 90vh;
              max-height: 800px;
              background: var(--white);
              border-radius: var(--border-radius);
              box-shadow: var(--shadow);
              display: flex;
              flex-direction: column;
              overflow: hidden;
              transform: translateY(0);
              transition: transform 0.3s ease;
          }
          
          .chat-container:hover {
              transform: translateY(-5px);
          }
          
          .chat-header {
              background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
              color: var(--white);
              padding: 20px;
              text-align: center;
              font-weight: 600;
              font-size: 1.2rem;
              display: flex;
              align-items: center;
              justify-content: center;
              gap: 12px;
              position: relative;
              overflow: hidden;
          }
          
          .chat-header::before {
              content: "";
              position: absolute;
              top: -50%;
              left: -50%;
              width: 200%;
              height: 200%;
              background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
              animation: pulse 8s infinite linear;
          }
          
          @keyframes pulse {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
          }
          
          .logo {
              width: 28px;
              height: 28px;
              background: var(--white);
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              color: var(--primary-color);
              font-weight: 700;
              font-size: 14px;
          }
          
          .chat-messages {
              flex: 1;
              padding: 20px;
              overflow-y: auto;
              display: flex;
              flex-direction: column;
              gap: 15px;
              background: var(--light-bg);
          }
          
          .message {
              max-width: 80%;
              padding: 12px 16px;
              border-radius: var(--border-radius);
              word-wrap: break-word;
              line-height: 1.5;
              position: relative;
              opacity: 0;
              transform: translateY(10px);
              animation: fadeIn 0.3s ease forwards;
          }
          
          @keyframes fadeIn {
              to {
                  opacity: 1;
                  transform: translateY(0);
              }
          }
          
          .user-message {
              align-self: flex-end;
              background: var(--primary-color);
              color: var(--white);
              border-bottom-right-radius: 4px;
              box-shadow: 0 4px 12px rgba(108, 99, 255, 0.3);
          }
          
          .bot-message {
              align-self: flex-start;
              background: var(--white);
              color: var(--dark-text);
              border-bottom-left-radius: 4px;
              box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
              border: 1px solid rgba(0, 0, 0, 0.05);
          }
          
          .chat-input-container {
              display: flex;
              padding: 15px;
              border-top: 1px solid rgba(0, 0, 0, 0.05);
              background: var(--white);
              align-items: center;
              position: relative;
          }
          
          #message-input {
              flex: 1;
              padding: 14px 20px;
              border: none;
              border-radius: 50px;
              outline: none;
              font-size: 14px;
              resize: none;
              height: 50px;
              max-height: 150px;
              overflow-y: auto;
              background: var(--light-bg);
              color: var(--dark-text);
              transition: all 0.3s ease;
          }
          
          #message-input:focus {
              box-shadow: 0 0 0 2px var(--primary-color);
          }
          
          #send-button {
              background: var(--primary-color);
              color: var(--white);
              border: none;
              border-radius: 50%;
              width: 46px;
              height: 46px;
              margin-left: 12px;
              cursor: pointer;
              display: flex;
              justify-content: center;
              align-items: center;
              transition: all 0.3s ease;
              box-shadow: 0 4px 12px rgba(108, 99, 255, 0.3);
          }
          
          #send-button:hover:not(:disabled) {
              background: var(--secondary-color);
              transform: translateY(-2px);
          }
          
          #send-button:active:not(:disabled) {
              transform: translateY(0);
          }
          
          #send-button:disabled {
              background: #cccccc;
              cursor: not-allowed;
              box-shadow: none;
          }
          
          .typing-indicator {
              display: flex;
              align-self: flex-start;
              padding: 12px 16px;
              background: var(--white);
              border-radius: var(--border-radius);
              margin-bottom: 10px;
              display: none;
              align-items: center;
              gap: 8px;
              box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
          }
          
          .typing-dot {
              width: 8px;
              height: 8px;
              background: var(--primary-color);
              border-radius: 50%;
              animation: typingAnimation 1.4s infinite ease-in-out;
          }
          
          .typing-dot:nth-child(1) {
              animation-delay: 0s;
          }
          
          .typing-dot:nth-child(2) {
              animation-delay: 0.2s;
          }
          
          .typing-dot:nth-child(3) {
              animation-delay: 0.4s;
          }
          
          @keyframes typingAnimation {
              0%, 60%, 100% { transform: translateY(0); }
              30% { transform: translateY(-5px); }
          }
          
          .markdown-content pre {
              background: rgba(108, 99, 255, 0.1);
              padding: 12px;
              border-radius: 8px;
              overflow-x: auto;
              margin: 8px 0;
              font-size: 0.85rem;
          }
          
          .markdown-content code {
              font-family: 'Courier New', monospace;
              background: rgba(108, 99, 255, 0.1);
              padding: 2px 6px;
              border-radius: 4px;
              font-size: 0.85rem;
              color: var(--primary-color);
          }
          
          .markdown-content ul,
          .markdown-content ol {
              padding-left: 24px;
              margin: 10px 0;
          }
          
          .markdown-content li {
              margin-bottom: 6px;
              position: relative;
          }
          
          .markdown-content li::before {
              content: "â€¢";
              color: var(--primary-color);
              position: absolute;
              left: -15px;
          }
          
          .markdown-content h1,
          .markdown-content h2,
          .markdown-content h3 {
              margin: 15px 0 10px 0;
              color: var(--dark-text);
          }
          
          .markdown-content h1 {
              font-size: 1.4rem;
          }
          
          .markdown-content h2 {
              font-size: 1.2rem;
          }
          
          .markdown-content h3 {
              font-size: 1.1rem;
          }
          
          .markdown-content p {
              margin: 10px 0;
              line-height: 1.6;
          }
          
          .markdown-content a {
              color: var(--primary-color);
              text-decoration: none;
              font-weight: 500;
              position: relative;
          }
          
          .markdown-content a::after {
              content: "";
              position: absolute;
              bottom: -2px;
              left: 0;
              width: 0;
              height: 2px;
              background: var(--primary-color);
              transition: width 0.3s ease;
          }
          
          .markdown-content a:hover::after {
              width: 100%;
          }
          
          .timestamp {
              font-size: 0.7rem;
              color: var(--light-text);
              margin-top: 4px;
              text-align: right;
          }
          
          @media (max-width: 600px) {
              .chat-container {
                  height: 100vh;
                  max-height: none;
                  border-radius: 0;
              }
              
              .chat-header {
                  border-radius: 0;
              }
          }
          
          /* Scrollbar styling */
          ::-webkit-scrollbar {
              width: 6px;
          }
          
          ::-webkit-scrollbar-track {
              background: rgba(108, 99, 255, 0.1);
              border-radius: 3px;
          }
          
          ::-webkit-scrollbar-thumb {
              background: rgba(108, 99, 255, 0.3);
              border-radius: 3px;
          }
          
          ::-webkit-scrollbar-thumb:hover {
              background: rgba(108, 99, 255, 0.5);
          }
      </style>
  </head>
  <body>
      <div class="chat-container">
          <div class="chat-header">
              <div class="logo">AG</div>
              <span>Akkusu GPT</span>
          </div>
          <div class="chat-messages" id="chat-messages">
              <div class="message bot-message">
                  <div class="markdown-content">Hello Akku! I'm your personal AI assistant, Akkusu GPT. How can I help you today?</div>
                  <div class="timestamp">Just now</div>
              </div>
              <div class="typing-indicator" id="typing-indicator">
                  <span>Akkusu is typing</span>
                  <div class="typing-dot"></div>
                  <div class="typing-dot"></div>
                  <div class="typing-dot"></div>
              </div>
          </div>
          <div class="chat-input-container">
              <textarea
                  id="message-input"
                  placeholder="Ask me anything, Akku..."
                  rows="1"
                  autocomplete="off"
              ></textarea>
              <button id="send-button">
                  <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      fill="currentColor"
                      viewBox="0 0 16 16"
                  >
                      <path
                          d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z"
                      />
                  </svg>
              </button>
          </div>
      </div>

      <script>
          document.addEventListener("DOMContentLoaded", function () {
              const chatMessages = document.getElementById("chat-messages");
              const messageInput = document.getElementById("message-input");
              const sendButton = document.getElementById("send-button");
              const typingIndicator = document.getElementById("typing-indicator");

              // Auto-resize textarea
              messageInput.addEventListener("input", function () {
                  this.style.height = "auto";
                  this.style.height = this.scrollHeight + "px";
              });

              // Scroll to bottom of chat
              function scrollToBottom() {
                  chatMessages.scrollTop = chatMessages.scrollHeight;
              }

              // Get current time in HH:MM format
              function getCurrentTime() {
                  const now = new Date();
                  return now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
              }

              // Simple markdown parser for bot responses
              function parseMarkdown(text) {
                  // Headers
                  text = text.replace(/^# (.*$)/gm, "<h1>$1</h1>");
                  text = text.replace(/^## (.*$)/gm, "<h2>$1</h2>");
                  text = text.replace(/^### (.*$)/gm, "<h3>$1</h3>");

                  // Bold and italic
                  text = text.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");
                  text = text.replace(/\*(.*?)\*/g, "<em>$1</em>");
                  text = text.replace(/\_(.*?)\_/g, "<em>$1</em>");

                  // Links
                  text = text.replace(
                      /\[(.*?)\]\((.*?)\)/g,
                      '<a href="$2" target="_blank">$1</a>'
                  );

                  // Lists
                  text = text.replace(/^\* (.*$)/gm, "<li>$1</li>");
                  text = text.replace(/^\- (.*$)/gm, "<li>$1</li>");
                  text = text.replace(/^\+ (.*$)/gm, "<li>$1</li>");
                  text = text.replace(/<li>.*<\/li>/g, function (match) {
                      if (!text.includes("<ul>")) {
                          return "<ul>" + match + "</ul>";
                      }
                      return match;
                  });

                  // Code blocks
                  text = text.replace(
                      /```([\s\S]*?)```/g,
                      "<pre><code>$1</code></pre>"
                  );
                  text = text.replace(/`(.*?)`/g, "<code>$1</code>");

                  // Paragraphs
                  text = text.replace(/^(?!<[a-z])(.*$)/gm, function (match) {
                      if (match.trim() === "") return "";
                      if (!match.startsWith("<")) return "<p>" + match + "</p>";
                      return match;
                  });

                  // Line breaks
                  text = text.replace(/\n/g, "<br>");

                  return text;
              }

              // Add message to chat with animation
              function addMessage(content, isUser) {
                  const messageDiv = document.createElement("div");
                  messageDiv.classList.add("message");
                  messageDiv.classList.add(isUser ? "user-message" : "bot-message");

                  const timestamp = document.createElement("div");
                  timestamp.classList.add("timestamp");
                  timestamp.textContent = getCurrentTime();

                  if (isUser) {
                      messageDiv.textContent = content;
                  } else {
                      messageDiv.innerHTML = `<div class="markdown-content">${parseMarkdown(
                          content
                      )}</div>`;
                  }

                  messageDiv.appendChild(timestamp);
                  chatMessages.insertBefore(messageDiv, typingIndicator);
                  
                  // Trigger animation
                  setTimeout(() => {
                      messageDiv.style.animation = "fadeIn 0.3s ease forwards";
                  }, 10);
                  
                  scrollToBottom();
              }

              // Send message to backend
              async function sendMessage() {
                  const message = messageInput.value.trim();
                  if (message === "") return;

                  // Disable input while sending
                  messageInput.disabled = true;
                  sendButton.disabled = true;

                  // Add user message to chat
                  addMessage(message, true);
                  messageInput.value = "";
                  messageInput.style.height = "auto";

                  // Show typing indicator
                  typingIndicator.style.display = "flex";
                  scrollToBottom();

                  try {
                      // Send message to backend
                      const response = await fetch("/api/chat", {
                          method: "POST",
                          headers: {
                              "Content-Type": "application/json",
                          },
                          body: JSON.stringify({ message }),
                      });

                      if (!response.ok) {
                          throw new Error("Network response was not ok");
                      }

                      const data = await response.json();

                      // Hide typing indicator and add bot response
                      typingIndicator.style.display = "none";
                      addMessage(data.reply, false);
                  } catch (error) {
                      console.error("Error:", error);
                      typingIndicator.style.display = "none";
                      addMessage(
                          "Sorry Akku, I'm having trouble connecting. Please try again later.",
                          false
                      );
                  } finally {
                      // Re-enable input
                      messageInput.disabled = false;
                      sendButton.disabled = false;
                      messageInput.focus();
                  }
              }

              // Event listeners
              sendButton.addEventListener("click", sendMessage);

              messageInput.addEventListener("keydown", function (e) {
                  if (e.key === "Enter" && !e.shiftKey) {
                      e.preventDefault();
                      sendMessage();
                  }
              });

              // Initial focus on input
              messageInput.focus();
              scrollToBottom();
          });
      </script>
  </body>
  </html>